(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function o(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(t){if(t.ep)return;t.ep=!0;const s=o(t);fetch(t.href,s)}})();const L="AIzaSyBgaHT2ShZl5o3hq6vak_RgbkU1j-waSo4",d="gemini-3.0-pro-preview",w="gemini-2.5-flash-preview-09-2025";let l=[];async function I(){const n=document.getElementById("model-status-text"),e=document.getElementById("model-status-light");n.innerText=`TARGET: ${d}`,e.className="status-dot fallback"}async function E(n,e){var t,s,i,u,m,p,f,g,y,h;const o=document.getElementById("model-status-text"),r=document.getElementById("model-status-light");o.innerText=`CONNECTING: ${d}`,r.className="status-dot online thinking-pulse";try{let c=await A(d,n,e);if(c.ok){const a=await c.json();return o.innerText=`ACTIVE: ${d}`,r.className="status-dot online",(m=(u=(i=(s=(t=a.candidates)==null?void 0:t[0])==null?void 0:s.content)==null?void 0:i.parts)==null?void 0:u[0])==null?void 0:m.text}else{const a=await c.text();throw console.error("Primary Model Error:",c.status,a),new Error("Primary Model Failed")}}catch(c){console.warn("Primary model failed or blocked by sandbox. Engaging Fallback Protocol."),console.error("Primary error details:",c),o.innerText=`FALLBACK: ${w}`,r.className="status-dot fallback";try{let a=await A(w,n,e);if(a.ok)return(h=(y=(g=(f=(p=(await a.json()).candidates)==null?void 0:p[0])==null?void 0:f.content)==null?void 0:g.parts)==null?void 0:y[0])==null?void 0:h.text;{const b=await a.text();throw console.error("Fallback Model Error:",a.status,b),new Error("Fallback Failed")}}catch(a){return console.error("Fallback error details:",a),o.innerText="SYSTEM OFFLINE",r.className="status-dot offline",`CRITICAL ERROR: Unable to establish reasoning link.

Check browser console for details (F12).

Common causes:
- Missing API key in .env file
- Invalid API key or no access to Gemini API
- Model name incorrect or unavailable`}}}async function A(n,e,o){const r=`https://generativelanguage.googleapis.com/v1beta/models/${n}:generateContent?key=${L}`;return fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:e}]}],systemInstruction:{parts:[{text:o}]}})})}async function v(){const n=document.getElementById("ai-input-prompt").value;if(!n)return;const e=document.getElementById("btn-run-optimizer"),o=document.getElementById("opt-res"),r=document.getElementById("opt-res-text");e.innerHTML='<span class="animate-spin mr-2">⟳</span> Architecting...',e.disabled=!0;const s=await E(n,"Act as Gemini 3 Pro. You are a Senior FlutterFlow Architect. Analyze the user request. Create a 'Master Prompt' that includes: 1. Strict null safety. 2. No external dependencies. 3. Constructor parameter mapping. 4. Stateless/Stateful wrapper. 5. No main(). Output ONLY the optimized prompt.");r.textContent=s,o.classList.remove("hidden"),e.innerHTML="Generate Master Prompt",e.disabled=!1}async function T(){const n=document.getElementById("ai-input-code").value;if(!n)return;const e=document.getElementById("btn-run-auditor"),o=document.getElementById("audit-res");e.innerHTML='<span class="animate-spin mr-2">⟳</span> Dissecting...',e.disabled=!0;const t=await E(`Audit this:
${n}`,"Act as a ruthless Code Auditor. Check Dart code for: 1. 'void main()' (FAIL). 2. External imports (FAIL). 3. Null safety violations (WARN). 4. Constructor argument mismatches (WARN). Return a short, brutal summary of why this code will fail in FlutterFlow.");o.innerHTML=`
    <div class="bg-red-500/10 border border-red-500/20 rounded-lg p-4">
      <h4 class="text-red-400 font-bold text-xs uppercase mb-2">Audit Log</h4>
      <p class="text-sm text-gray-300 font-mono whitespace-pre-wrap">${t}</p>
    </div>
  `,o.classList.remove("hidden"),e.innerHTML="Run Integration Audit",e.disabled=!1}function x(n){document.querySelectorAll(".nav-link").forEach(r=>r.classList.remove("active")),document.getElementById(`nav-${n}`).classList.add("active");const e=document.getElementById("main-stage"),o=document.getElementById(`tpl-${n}`);e.innerHTML=o.innerHTML,n==="overview"&&setTimeout(C,0)}function C(){l.forEach(o=>o.destroy()),l=[];const n=document.getElementById("chart-integrity").getContext("2d");l.push(new Chart(n,{type:"bar",data:{labels:["Standard Gen","G3 Architected"],datasets:[{label:"Build Success",data:[22,98],backgroundColor:["#3f3f46","#6366f1"],borderRadius:6}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{grid:{color:"#27272a"},ticks:{color:"#71717a"}},x:{grid:{display:!1},ticks:{color:"#a1a1aa"}}}}}));const e=document.getElementById("chart-bottlenecks").getContext("2d");l.push(new Chart(e,{type:"doughnut",data:{labels:["Null Safety","Dependencies","Boilerplate"],datasets:[{data:[45,35,20],backgroundColor:["#6366f1","#a855f7","#3f3f46"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"75%",plugins:{legend:{position:"bottom",labels:{color:"#a1a1aa",font:{size:10}}}}}}))}document.addEventListener("DOMContentLoaded",()=>{I(),x("overview")});window.switchView=x;window.runAiOptimizer=v;window.runAiAuditor=T;
